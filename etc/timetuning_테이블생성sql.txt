-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.

-- User Table Create SQL
CREATE TABLE User
(
    `userIdx`        INT            NOT NULL    AUTO_INCREMENT COMMENT '유저 번호', 
    `userId`         VARCHAR(45)    NOT NULL    COMMENT '유저 아이디', 
    `userName`       VARCHAR(45)    NOT NULL    COMMENT '유저 이름', 
    `profileImgUrl`  TEXT           NULL        COMMENT '유저 프로필 사진', 
    `userEmail`      VARCHAR(45)    NULL        COMMENT '유저 이메일', 
    `password`       VARCHAR(45)    NOT NULL    COMMENT '비밀번호', 
     PRIMARY KEY (userIdx, userId)
);

ALTER TABLE User COMMENT '유저테이블';


-- Schedule Table Create SQL
CREATE TABLE Schedule
(
    `scheduleIdx`    INT             NOT NULL    AUTO_INCREMENT COMMENT '일정 번호', 
    `userIdx`        INT             NOT NULL    COMMENT '유저 번호', 
    `scheduleTitle`  VARCHAR(100)    NOT NULL    COMMENT '일정 제목', 
    `scheduleCom`    VARCHAR(100)    NULL        COMMENT '일정 설명', 
    `scheduleColor`  TEXT            NULL        COMMENT '일정 배경색', 
    `startYMD`       DATETIME        NOT NULL    COMMENT '일정 시작일', 
    `endYMD`         DATETIME        NOT NULL    COMMENT '일정 종료일', 
     PRIMARY KEY (scheduleIdx)
);

ALTER TABLE Schedule COMMENT '일정 테이블';

ALTER TABLE Schedule
    ADD CONSTRAINT FK_Schedule_userIdx_User_userIdx FOREIGN KEY (userIdx)
        REFERENCES User (userIdx) ON DELETE RESTRICT ON UPDATE RESTRICT;


-- ScheduleMember Table Create SQL
CREATE TABLE ScheduleMember
(
    `scheduleIdx`  INT            NOT NULL    COMMENT '일정 번호', 
    `userIdx`      INT            NOT NULL    COMMENT '유저 번호', 
    `userId`       VARCHAR(45)    NOT NULL    COMMENT '유저 아이디', 
     PRIMARY KEY (scheduleIdx, userIdx, userId)
);

ALTER TABLE ScheduleMember COMMENT '참여 멤버 테이블';

ALTER TABLE ScheduleMember
    ADD CONSTRAINT FK_ScheduleMember_scheduleIdx_Schedule_scheduleIdx FOREIGN KEY (scheduleIdx)
        REFERENCES Schedule (scheduleIdx) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE ScheduleMember
    ADD CONSTRAINT FK_ScheduleMember_userIdx_User_userIdx FOREIGN KEY (userIdx, userId)
        REFERENCES User (userIdx, userId) ON DELETE RESTRICT ON UPDATE RESTRICT;


